{"version":3,"file":"format-DgO97vlP.js","sources":["../../src/utils/format.ts"],"sourcesContent":["import BigNumber from 'bignumber.js'\r\n\r\n/**\r\n * Utility functions for formatting numbers, dates, and other data\r\n */\r\n\r\nexport const formatNumberK = (value: number | string,\r\n  decimals: number = 2): string => {\r\n  return formatNumber(value, decimals, 'en-US', 3)\r\n}\r\n\r\nexport const formatNumberM = (value: number | string,\r\n  decimals: number = 2): string => {\r\n  return formatNumber(value, decimals, 'en-US', 3)\r\n}\r\n\r\n/**\r\n * Format a number with commas and specified decimal places\r\n * @param value - The number to format\r\n * @param decimals - Number of decimal places (default: 2)\r\n * @param locale - Locale for formatting (default: 'en-US')\r\n * @param minAbbreviated - Minimum value to use abbreviated format (K, M, B) (default: '')\r\n * @returns Formatted number string\r\n */\r\nexport const formatNumber = (\r\n  value: number | string,\r\n  decimals: number = 2,\r\n  locale: string = 'en-US',\r\n  minAbbreviated: number = 0, // 3:K, 2:M, 1:B\r\n): string => {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value\r\n\r\n  if (isNaN(num)) return '0'\r\n\r\n  // 如果启用简写功能\r\n  if (minAbbreviated > 0) {\r\n    const absNum = Math.abs(num)\r\n    if (absNum >= 1e12 && minAbbreviated >= 1) {\r\n      return removeTrailingZeros((num / 1e12).toFixed(2)) + 'T'\r\n    }\r\n    if (absNum >= 1e9 && minAbbreviated >= 1) {\r\n      return removeTrailingZeros((num / 1e9).toFixed(2)) + 'B'\r\n    }\r\n    if (absNum >= 1e6 && minAbbreviated >= 2) {\r\n      return removeTrailingZeros((num / 1e6).toFixed(2)) + 'M'\r\n    }\r\n    if (absNum >= 1e3 && minAbbreviated >= 3) {\r\n      return removeTrailingZeros((num / 1e3).toFixed(2)) + 'K'\r\n    }\r\n  }\r\n\r\n  // 使用截取而非四舍五入\r\n  const factor = Math.pow(10, decimals)\r\n  const truncatedNum = Math.floor(num * factor) / factor\r\n\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    minimumFractionDigits: decimals,\r\n    maximumFractionDigits: decimals\r\n  }).format(truncatedNum)\r\n\r\n  // 如果格式化后为0但原始值不等于0，添加\"<\"符号\r\n  if (formatted === '0.00' || formatted === '0' || parseFloat(formatted) === 0) {\r\n    if (num > 0) {\r\n      // 显示最小精度单位\r\n      const minValue = 1 / Math.pow(10, decimals)\r\n      const minFormatted = new Intl.NumberFormat(locale, {\r\n        minimumFractionDigits: decimals,\r\n        maximumFractionDigits: decimals\r\n      }).format(minValue)\r\n      return `<${removeTrailingZeros(minFormatted)}`\r\n    }\r\n  }\r\n\r\n  return removeTrailingZeros(formatted)\r\n}\r\n\r\n/**\r\n * Format a number as currency\r\n * @param value - The number to format\r\n * @param currency - Currency code (default: 'USD')\r\n * @param locale - Locale for formatting (default: 'en-US')\r\n * @returns Formatted currency string\r\n */\r\nexport const formatCurrency = (\r\n  value: number | string,\r\n  currency: string = 'USD',\r\n  locale: string = 'en-US'\r\n): string => {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value\r\n\r\n  if (isNaN(num)) return '$0.00'\r\n\r\n  return new Intl.NumberFormat(locale, {\r\n    style: 'currency',\r\n    currency\r\n  }).format(num)\r\n}\r\n\r\n/**\r\n * Remove trailing zeros from decimal part\r\n * @param numStr - Number string with potential trailing zeros\r\n * @returns Number string without trailing zeros\r\n */\r\nconst removeTrailingZeros = (numStr: string): string => {\r\n  if (numStr.includes('.')) {\r\n    return numStr.replace(/\\.?0+$/, '')\r\n  }\r\n  return numStr\r\n}\r\n\r\n/**\r\n * Format a large number with K, M, B, T suffixes\r\n * @param value - The number to format\r\n * @param decimals - Number of decimal places (default: 1)\r\n * @returns Formatted number string with suffix\r\n */\r\nexport const formatLargeNumber = (\r\n  value: number | string,\r\n  decimals: number = 1\r\n): string => {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value\r\n\r\n  if (isNaN(num)) return '0'\r\n\r\n  const absNum = Math.abs(num)\r\n  const sign = num < 0 ? '-' : ''\r\n\r\n  if (absNum >= 1e12) {\r\n    return sign + removeTrailingZeros(Math.floor(absNum / 1e12 * Math.pow(10, decimals)) / Math.pow(10, decimals) + '') + 'T'\r\n  } else if (absNum >= 1e9) {\r\n    return sign + removeTrailingZeros(Math.floor(absNum / 1e9 * Math.pow(10, decimals)) / Math.pow(10, decimals) + '') + 'B'\r\n  } else if (absNum >= 1e6) {\r\n    return sign + removeTrailingZeros(Math.floor(absNum / 1e6 * Math.pow(10, decimals)) / Math.pow(10, decimals) + '') + 'M'\r\n  } else if (absNum >= 1e3) {\r\n    return sign + removeTrailingZeros(Math.floor(absNum / 1e3 * Math.pow(10, decimals)) / Math.pow(10, decimals) + '') + 'K'\r\n  }\r\n\r\n  return sign + removeTrailingZeros(Math.floor(absNum * Math.pow(10, decimals)) / Math.pow(10, decimals) + '')\r\n}\r\n\r\n/**\r\n * Format a percentage\r\n * @param value - The decimal value (e.g., 0.05 for 5%)\r\n * @param decimals - Number of decimal places (default: 2)\r\n * @returns Formatted percentage string\r\n */\r\nexport const formatPercentage = (\r\n  value: number | string,\r\n  decimals: number = 2\r\n): string => {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value\r\n\r\n  if (isNaN(num)) return '0%'\r\n\r\n  return (num * 100).toFixed(decimals) + '%'\r\n}\r\n\r\n/**\r\n * Format a date\r\n * @param date - Date to format (timestamp, Date object, or date string)\r\n * @param options - Intl.DateTimeFormat options\r\n * @param locale - Locale for formatting (default: 'en-US')\r\n * @returns Formatted date string\r\n */\r\nexport const formatDate = (\r\n  date: number | Date | string,\r\n  options: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric'\r\n  },\r\n  locale: string = 'en-US'\r\n): string => {\r\n  let dateObj: Date\r\n\r\n  if (typeof date === 'number') {\r\n    dateObj = new Date(date)\r\n  } else if (typeof date === 'string') {\r\n    dateObj = new Date(date)\r\n  } else {\r\n    dateObj = date\r\n  }\r\n\r\n  if (isNaN(dateObj.getTime())) return 'Invalid Date'\r\n\r\n  return new Intl.DateTimeFormat(locale, options).format(dateObj)\r\n}\r\n\r\n/**\r\n * Format a date and time\r\n * @param date - Date to format\r\n * @param locale - Locale for formatting (default: 'en-US')\r\n * @returns Formatted date and time string\r\n */\r\nexport const formatDateTime = (\r\n  date: number | Date | string,\r\n  locale: string = 'en-US'\r\n): string => {\r\n  return formatDate(date, {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  }, locale)\r\n}\r\n\r\n/**\r\n * Format time ago (relative time)\r\n * @param date - Date to compare\r\n * @param locale - Locale for formatting (default: 'en-US')\r\n * @returns Relative time string (e.g., '2 hours ago')\r\n */\r\nexport const formatTimeAgo = (\r\n  date: number | Date | string,\r\n  locale: string = 'en-US'\r\n): string => {\r\n  let dateObj: Date\r\n\r\n  if (typeof date === 'number') {\r\n    dateObj = new Date(date)\r\n  } else if (typeof date === 'string') {\r\n    dateObj = new Date(date)\r\n  } else {\r\n    dateObj = date\r\n  }\r\n\r\n  if (isNaN(dateObj.getTime())) return 'Invalid Date'\r\n\r\n  const now = new Date()\r\n  const diffInSeconds = Math.floor((now.getTime() - dateObj.getTime()) / 1000)\r\n\r\n  const rtf = new Intl.RelativeTimeFormat(locale, { numeric: 'auto' })\r\n\r\n  if (diffInSeconds < 60) {\r\n    return rtf.format(-diffInSeconds, 'second')\r\n  } else if (diffInSeconds < 3600) {\r\n    return rtf.format(-Math.floor(diffInSeconds / 60), 'minute')\r\n  } else if (diffInSeconds < 86400) {\r\n    return rtf.format(-Math.floor(diffInSeconds / 3600), 'hour')\r\n  } else if (diffInSeconds < 2592000) {\r\n    return rtf.format(-Math.floor(diffInSeconds / 86400), 'day')\r\n  } else if (diffInSeconds < 31536000) {\r\n    return rtf.format(-Math.floor(diffInSeconds / 2592000), 'month')\r\n  } else {\r\n    return rtf.format(-Math.floor(diffInSeconds / 31536000), 'year')\r\n  }\r\n}\r\n\r\n/**\r\n * Format an Ethereum address\r\n * @param address - The address to format\r\n * @param startLength - Number of characters to show at start (default: 6)\r\n * @param endLength - Number of characters to show at end (default: 4)\r\n * @returns Formatted address string\r\n */\r\nexport const formatAddress = (\r\n  address: string,\r\n  startLength: number = 6,\r\n  endLength: number = 4\r\n): string => {\r\n  if (!address || address.length < startLength + endLength) {\r\n    return address || ''\r\n  }\r\n\r\n  return `${address.slice(0, startLength)}...${address.slice(-endLength)}`\r\n}\r\n\r\n/**\r\n * Format a transaction hash\r\n * @param hash - The transaction hash\r\n * @param length - Number of characters to show (default: 10)\r\n * @returns Formatted hash string\r\n */\r\nexport const formatTxHash = (\r\n  hash: string,\r\n  length: number = 10\r\n): string => {\r\n  if (!hash || hash.length <= length) {\r\n    return hash || ''\r\n  }\r\n\r\n  const halfLength = Math.floor(length / 2)\r\n  return `${hash.slice(0, halfLength)}...${hash.slice(-halfLength)}`\r\n}\r\n\r\n/**\r\n * Format token amount with proper decimals\r\n * @param amount - The amount in wei or smallest unit\r\n * @param decimals - Token decimals (default: 18)\r\n * @param displayDecimals - Number of decimals to display (default: 4)\r\n * @returns Formatted token amount\r\n */\r\nexport const formatTokenAmount = (\r\n  amount: string | number,\r\n  decimals: number = 18,\r\n  displayDecimals: number = 4\r\n): string => {\r\n  const amountStr = typeof amount === 'number' ? amount.toString() : amount\r\n\r\n  if (!amountStr || amountStr === '0') return '0'\r\n\r\n  const divisor = Math.pow(10, decimals)\r\n  const value = parseFloat(amountStr) / divisor\r\n\r\n  return formatNumber(value, displayDecimals)\r\n}\r\n\r\n/**\r\n * Format gas price in Gwei\r\n * @param gasPrice - Gas price in wei\r\n * @returns Formatted gas price string\r\n */\r\nexport const formatGasPrice = (gasPrice: string | number): string => {\r\n  const gasPriceStr = typeof gasPrice === 'number' ? gasPrice.toString() : gasPrice\r\n\r\n  if (!gasPriceStr || gasPriceStr === '0') return '0 Gwei'\r\n\r\n  const gwei = parseFloat(gasPriceStr) / 1e9\r\n  return `${formatNumber(gwei, 2)} Gwei`\r\n}\r\n\r\n/**\r\n * Format file size\r\n * @param bytes - Size in bytes\r\n * @param decimals - Number of decimal places (default: 2)\r\n * @returns Formatted file size string\r\n */\r\nexport const formatFileSize = (\r\n  bytes: number,\r\n  decimals: number = 2\r\n): string => {\r\n  if (bytes === 0) return '0 Bytes'\r\n\r\n  const k = 1024\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n\r\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(decimals))} ${sizes[i]}`\r\n}\r\n\r\n/**\r\n * Truncate text with ellipsis\r\n * @param text - Text to truncate\r\n * @param maxLength - Maximum length (default: 50)\r\n * @returns Truncated text\r\n */\r\nexport const truncateText = (\r\n  text: string,\r\n  maxLength: number = 50\r\n): string => {\r\n  if (!text || text.length <= maxLength) {\r\n    return text || ''\r\n  }\r\n\r\n  return text.slice(0, maxLength) + '...'\r\n}\r\n\r\n/**\r\n * Format duration in human readable format\r\n * @param seconds - Duration in seconds\r\n * @returns Formatted duration string\r\n */\r\nexport const formatDuration = (seconds: number): string => {\r\n  if (seconds < 60) {\r\n    return `${seconds}s`\r\n  } else if (seconds < 3600) {\r\n    const minutes = Math.floor(seconds / 60)\r\n    const remainingSeconds = seconds % 60\r\n    return remainingSeconds > 0 ? `${minutes}m ${remainingSeconds}s` : `${minutes}m`\r\n  } else if (seconds < 86400) {\r\n    const hours = Math.floor(seconds / 3600)\r\n    const remainingMinutes = Math.floor((seconds % 3600) / 60)\r\n    return remainingMinutes > 0 ? `${hours}h ${remainingMinutes}m` : `${hours}h`\r\n  } else {\r\n    const days = Math.floor(seconds / 86400)\r\n    const remainingHours = Math.floor((seconds % 86400) / 3600)\r\n    return remainingHours > 0 ? `${days}d ${remainingHours}h` : `${days}d`\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate percentage of a balance with high precision (supports 18 decimal places)\r\n * Uses ethers.js utilities for precise calculations to avoid floating point precision issues\r\n * @param balance - The total balance as string\r\n * @param percentage - The percentage (0-100)\r\n * @param decimals - Number of decimal places to return (default: 6)\r\n * @returns Calculated amount as string\r\n */\r\nexport const calculatePercentageAmount = (\r\n  balance: string,\r\n  percentage: number,\r\n  decimals: number = 18\r\n): string => {\r\n  if (!balance || balance === '0' || percentage === 0) {\r\n    return '0'\r\n  }\r\n\r\n  try {\r\n    const bigAmout = new BigNumber(balance)\r\n    return bigAmout.multipliedBy(percentage).dividedBy(100).toFixed(decimals);\r\n  } catch (error) {\r\n    console.error('Error calculating percentage amount:', error)\r\n    return '0'\r\n  }\r\n}"],"names":["formatNumberK","value","decimals","formatNumber","locale","minAbbreviated","num","absNum","removeTrailingZeros","factor","truncatedNum","formatted","minValue","minFormatted","numStr","formatLargeNumber","sign","formatDate","date","options","dateObj","formatTimeAgo","diffInSeconds","rtf","calculatePercentageAmount","balance","percentage","BigNumber","error"],"mappings":"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"}